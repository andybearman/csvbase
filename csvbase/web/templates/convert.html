{# -*- mode: jinja2 -*- #}
{% extends "app_base.html" %}

{% block main %}
  <div class="container">
    <h1>Convert a file</h1>

    <form action="{{ action_url }}" method="POST" enctype="multipart/form-data">
      <div class="mb-3">
        <input type="file" class="form-control" name="file" accept=".csv,text/csv">
      </div>

      <div class="mb-3 row g-3">
        <div class="col-auto">
          <label for="from-type-select" class="col-form-label">From</label>
        </div>
        <div class="col-auto">
          <select class="form-select" name="from">
              <option selected
                value="csv">CSV</option>
          </select>
        </div>
      </div>

      <div class="mb-3 row g-3">
        <div class="col-auto">
          <label for="to-type-select" class="col-form-label">To</label>
        </div>
        <div class="col-auto">
          <select class="form-select" name="to">
            {% for output_format in output_formats %}
              <option {% if output_format == default_output_format %}selected{% endif %}
                      value="{{ output_format.value }}">{{ output_format.pretty_name() }}</option>
            {% endfor %}
          </select>
        </div>
      </div>


      {% if not g.current_user %}
        <p>As you&apos;re not logged in, please create an account.  (If you already have an account, <a href="{{ url_for('csvbase.sign_in') }}">sign in</a>.)</p>
      <p>
        <label>Username</label>
        <input type="text" name="username" required pattern="^[A-z][-A-z0-9]+"
               title="Letters, numbers and dashes only.  Must start with a letter">
      </p>
      <p>
        <label>(Optional) Email</label>
        <input type="text" name="email" pattern=".*@.*"
               title="Must contain an @-sign">
      </p>
      <p>
        <label>Password</label>
        <input type="password" required name="password">
      </p>
    {% endif %}

    <div class="mb-3">
        <input type="submit" class="btn btn-primary" value="Convert">
    </div>
    </form>
  </div>
{% endblock %}
